#!/bin/bash

zip2john=~/Desktop/CTF_Tools/john/run/./zip2john
john=~/Desktop/CTF_Tools/john/run/./john

filename=$1

rm -r tmp
mkdir tmp
cp $filename tmp
cd tmp

y=""

while [ 1 ]
do
	file $filename | grep "Zip"
	if [ "$?" -eq "0" ]
	then
		echo "$filename"
		$zip2john $filename > hash
		$john hash
		x=$($john --show hash)
		pass=$(echo $x | cut -d':' -f 2)
		y="$y$pass"
		unzip -P$pass $filename
	       	rm $filename
		rm hash
		filename=$(ls *)

	fi
	
	file $filename | grep "PNG"
	if [ "$?" -eq "0" ]
	then
		echo "$y"		
		break
	fi
done	

cd ..
rm  -r tmp



	
		



